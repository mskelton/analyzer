generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["mongoDb"]
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id       String @id @default(dbgenerated()) @map("_id") @db.ObjectId
  arn      String @unique
  accounts Account[]

  email    String @unique
  password String
  name     String
}

enum AccountType {
  DEMO
  LIVE
}

model Account {
  id           String @id @default(dbgenerated()) @map("_id") @db.ObjectId
  arn          String @unique
  userArn      String
  user         User   @relation(fields: [userArn], references: [arn])
  deals        Deal[]

  name         String
  broker       String
  type         AccountType
  lastUpdated  DateTime?
}

model Deal {
  id         String  @id @default(dbgenerated()) @map("_id") @db.ObjectId
  arn        String  @unique
  accountArn String
  account    Account @relation(fields: [accountArn], references: [arn])

  comment    String?
  commission Float?
  entry      String
  fee        Float?
  magic      Int?
  price      Float?
  profit     Float?
  reason     String
  sl         Float?
  swap       Float?
  symbol     String?
  ticket     Int
  time       Int
  tp         Float?
  type       String
  volume     Float?

  @@unique([accountArn, ticket])
}
